import{J as w,r as f,t as C,j as e,B as y,Q as l,v as b,F as v,x as i,y as t,A as c,I as d,D as m,w as S,K as F}from"./index-BHqYEVpr.js";import{P as D}from"./page-head-DnRIryst.js";import{a as P,d as A,c as M}from"./api-fvz03lhi.js";import{u as q,D as _}from"./data-table-skeleton-CmbjhmVS.js";import{E as T,S as k,T as I,D as B}from"./table-search-input-OFx9dtpd.js";import{A as K}from"./alert-modal-BbSlZVHF.js";import{A as N,D as L,a as $,b as O,c as H,f as u,B as R}from"./dropdown-menu-B2q1b40F.js";import{T as V}from"./trash-Cqpd8zjW.js";import{P as z}from"./popup-modal-C7Hv1q3z.js";import{H as G}from"./heading-DLKN7QJX.js";import{S as Q,a as U,b as J,c as Y,e as W,f as X,d as g}from"./select-DFVNYac5.js";import{B as Z}from"./breadcrumbs-CxWpwQan.js";import"./axios-Cm0UX6qg.js";import"./index-BiMNKS6m.js";import"./scroll-area-Kh0p6MKS.js";import"./chevron-left-DTSZ-l0x.js";import"./index-KnQW5NRs.js";import"./Combination-C5Dgzbfj.js";import"./index-VWaDGczM.js";const ee=(s,n,a)=>q({queryKey:["employees",s,n,a],queryFn:async()=>P(s,n,a)}),se=({data:s})=>{const{role:n,isAdmin:a}=N(),p=w(),[r]=f.useState(!1),[o,x]=f.useState(!1),h=C(),j=async()=>{await A(s.id),x(!1),p("/employee"),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(K,{isOpen:o,onClose:()=>x(!1),onConfirm:j,loading:r}),e.jsxs(L,{modal:!1,children:[e.jsx($,{asChild:!0,children:e.jsxs(y,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(T,{className:"h-4 w-4"})]})}),e.jsxs(O,{align:"end",children:[e.jsx(H,{children:"Actions"}),e.jsxs(u,{onClick:()=>h.push(`/employee/details/${s.id}`),children:[e.jsx(R,{className:"mr-2 h-4 w-4"})," Details"]}),a&&e.jsxs(u,{onClick:()=>h.push(`/employee/update/${s.id}`),children:[e.jsx(k,{className:"mr-2 h-4 w-4"})," Update"]}),n==="root"&&e.jsxs(u,{onClick:()=>x(!0),children:[e.jsx(V,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})]})},re=[{accessorKey:"username",header:"ID"},{accessorFn:s=>`${s.first_name} ${s.middle_name} ${s.last_name}`.trim(),id:"full_name",header:"NAME"},{accessorKey:"role",header:"ROLE"},{accessorKey:"email",header:"EMAIL"},{accessorKey:"phone",header:"PHONE"},{id:"actions",cell:({row:s})=>e.jsx(se,{data:s.original})}],ae=l.object({first_name:l.string({required_error:"First name is required"}).min(1,{message:"firstname is should be at least 1 character"}),middle_name:l.string().min(1,{message:"middlename is required"}),last_name:l.string().min(1,{message:"lastname is required"}),username:l.string().min(1,{message:"username is required"}),role:l.string().min(1,{message:"role is required"}),email:l.string().email({message:"Enter a valid email address"}),phone:l.string().min(10,{message:"Enter a valid phone number"}),password:l.string().min(1,{message:"Password is required"}),confirmPassword:l.string().min(1,{message:"Confirm Password is required"})}).refine(s=>s.password===s.confirmPassword,{message:"Passwords must match",path:["confirmPassword"]}),ne=({modalClose:s})=>{const n=w(),a=b({resolver:S(ae),defaultValues:{}}),p=r=>{M(r),s(),n("/employee"),window.location.reload()};return e.jsxs("div",{className:"px-2",children:[e.jsx(G,{title:"Create New Employee",description:"",className:"space-y-2 py-10 text-center"}),e.jsx(v,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(p),className:"space-y-12",autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 gap-y-4",children:[e.jsx(i,{control:a.control,name:"first_name",render:({field:r})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Firstname",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"middle_name",render:({field:r})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Middlename",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"last_name",render:({field:r})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Lastname",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})})]}),e.jsxs("div",{className:" grid grid-cols-2 gap-x-8 gap-y-4",children:[e.jsx(i,{control:a.control,name:"username",render:({field:r})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Enter username",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"role",render:({field:r})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsxs(Q,{onValueChange:o=>r.onChange(o),defaultValue:r.value,children:[e.jsx(U,{className:"w-full px-4 py-6 shadow-inner drop-shadow-xl",children:e.jsx(J,{placeholder:"Select Role"})}),e.jsx(Y,{children:e.jsxs(W,{children:[e.jsx(X,{children:"Designation"}),e.jsx(g,{value:"engineer",children:"Engineer"}),e.jsx(g,{value:"senior",children:"Senior"}),e.jsx(g,{value:"admin",children:"Admin"})]})})]})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"email",render:({field:r})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Enter email",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"phone",render:({field:r})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Enter phone",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"password",render:({field:r})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Create password",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:a.control,name:"confirmPassword",render:({field:r})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Confirm password",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})})]})]}),e.jsxs("div",{className:" flex items-center justify-center gap-4",children:[e.jsx(y,{type:"button",variant:"secondary",className:"rounded-full ",size:"lg",onClick:s,children:"Cancel"}),e.jsx(y,{type:"submit",className:"rounded-full",size:"lg",children:"Create Employee"})]})]})})]})},oe=ne;function le(){const{isAdmin:s}=N();return e.jsxs("div",{className:"flex items-center justify-between gap-2 py-5",children:[e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx(I,{placeholder:"Search Employees "})}),e.jsx("div",{className:"flex gap-3",children:s&&e.jsx(z,{title:"Employee",renderModal:n=>e.jsx(oe,{modalClose:n})})})]})}function ie({employees:s,pageCount:n}){return e.jsxs(e.Fragment,{children:[e.jsx(le,{}),s&&e.jsx(B,{columns:re,data:s,pageCount:n})]})}function Fe(){const[s]=F(),n=Number(s.get("page")||1),a=Number(s.get("limit")||10),p=s.get("search")||null,r=(n-1)*a,{data:o,isLoading:x}=ee(r,a,p),h=o==null?void 0:o.employees,j=o==null?void 0:o.totalEmployees,E=o==null?void 0:o.pageCount;return x?e.jsx("div",{className:"p-5",children:e.jsx(_,{columnCount:10,filterableColumnCount:2,searchableColumnCount:1})}):e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsx(D,{title:"Employee Management | YSEC"}),e.jsx("div",{className:"flex justify-between",children:e.jsx(Z,{items:[{title:"Dashboard",link:"/"},{title:"Employees",link:"/employees"}]})}),e.jsx(ie,{employees:h,page:n,totalEmployees:j,pageCount:E})]})}export{Fe as default};
