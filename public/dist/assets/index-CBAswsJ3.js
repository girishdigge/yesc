import{a3 as f,r as p,D as d,j as e,B as h,a4 as P}from"./index-Cmx8tmCA.js";import{P as y}from"./page-head-JZbgdBkr.js";import{a as N,d as A}from"./projectAPI-RDAELPg6.js";import{u as C,D}from"./data-table-skeleton-bOwXvGz_.js";import{E as S,S as T,T as b,D as w}from"./table-search-input-Db5kKJn_.js";import{A as E}from"./alert-modal-C-Gwbevh.js";import{D as v,c as B,d as _,f as I,e as u,B as K,P as O}from"./dropdown-menu-T7PwpJO5.js";import{A as x,T as k}from"./auth-BNJ9dyam.js";import{B as M}from"./breadcrumbs-DFTZUQU8.js";import"./index-B7XoVwBY.js";import"./scroll-area-C6kJR1FW.js";import"./select-BSNOABov.js";import"./Combination-tArbcmjf.js";import"./chevron-left-ehNR0xsy.js";import"./dialog-Cd46RHKw.js";import"./index-yjJknjLS.js";import"./index-VWaDGczM.js";const R=localStorage.getItem("username")||"",J=localStorage.getItem("role")||"",L=(s,r,n)=>C({queryKey:["projects",s,r,n],queryFn:async()=>N(s,r,n,R,J)}),G=({data:s})=>{const{role:r,isAdmin:n}=x(),i=f(),[l]=p.useState(!1),[o,c]=p.useState(!1),a=d(),m=async()=>{await A(s.id),c(!1),i("/projects"),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(E,{isOpen:o,onClose:()=>c(!1),onConfirm:m,loading:l}),e.jsxs(v,{modal:!1,children:[e.jsx(B,{asChild:!0,children:e.jsxs(h,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(S,{className:"h-4 w-4"})]})}),e.jsxs(_,{align:"end",children:[e.jsx(I,{children:"Actions"}),e.jsxs(u,{onClick:()=>a.push(`/project/details/${s.id}`),children:[e.jsx(K,{className:"mr-2 h-4 w-4"})," Details"]}),n&&e.jsxs(u,{onClick:()=>a.push(`/project/edit/${s.id}`),children:[e.jsx(T,{className:"mr-2 h-4 w-4"})," Edit Project"]}),r==="root"&&e.jsxs(u,{onClick:()=>c(!0),children:[e.jsx(k,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})]})},U=[{accessorKey:"id",header:"ID"},{accessorKey:"Project_Name",header:"PROJECT"},{accessorKey:"Project_Job_Category",header:"CATEGORY"},{accessorKey:"Project_Job_Number",header:"JOB NO."},{accessorKey:"Inhouse_Engineer",header:"ENGINEER ALLOTED"},{accessorKey:"Project_Status",header:"PROJECT STATUS"},{accessorKey:"Building_Status",header:"BUILDING STATUS"},{accessorKey:"Assigned_Date",header:"DATE"},{header:"Actions",id:"actions",cell:({row:s})=>e.jsx(G,{data:s.original})}];function q(){const{isAdmin:s}=x(),r=d();return e.jsxs("div",{className:"flex items-center justify-between gap-2 py-5",children:[e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx(b,{placeholder:"Search Projects"})}),e.jsx("div",{className:"flex gap-3",children:s&&e.jsxs(h,{onClick:()=>r.push("/projects/add-project"),children:[e.jsx(O,{className:"mr-2 h-4 w-4"})," Add New Project"]})})]})}function F({projects:s,pageCount:r}){return e.jsxs(e.Fragment,{children:[e.jsx(q,{}),s&&e.jsx(w,{columns:U,data:s,pageCount:r})]})}function ie(){const[s]=P(),r=Number(s.get("page")||1),n=Number(s.get("limit")||10),i=s.get("search")||null,l=(r-1)*n,{data:o,isLoading:c}=L(l,n,i),a=o==null?void 0:o.projects;a==null||a.map(t=>{var j;console.log(t.Activity[t.Activity.length-1]),t.Building_Status=t==null?void 0:t.Activity[((j=t==null?void 0:t.Activity)==null?void 0:j.length)-1]});const m=o==null?void 0:o.totalProjects,g=o==null?void 0:o.pageCount;return c?e.jsx("div",{className:"p-5",children:e.jsx(D,{columnCount:10,filterableColumnCount:2,searchableColumnCount:1})}):e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsx(y,{title:"Project Management | YSEC"}),e.jsx("div",{className:"flex justify-between",children:e.jsx(M,{items:[{title:"Dashboard",link:"/"},{title:"Projects",link:"/projects"}]})}),e.jsx(F,{projects:a,page:r,totalProjects:m,pageCount:g})]})}export{ie as default};
