import{a3 as w,r as g,z as E,j as e,B as y,af as n,S as I,U as _,V as m,W as h,X as j,Y as x,I as f,Z as u,T as F,a7 as A,a4 as M}from"./index-BLqXuCnr.js";import{P as v}from"./page-head-VzjWYUDB.js";import{u as q}from"./queries-DObSSwvz.js";import{E as V,S as k,T as K,D as B}from"./table-search-input--87h2RvB.js";import{A as L}from"./alert-modal-C9pp_1Di.js";import{D as Y,a as O,b as R,c as z,f as N,B as U}from"./dropdown-menu-dHZaePSY.js";import{d as $,c as H}from"./todoAPI-ChJvsW9-.js";import{A as P,T as G}from"./auth-bzn4Wv-G.js";import{P as J}from"./popup-modal-z7OdiKKz.js";import{H as W}from"./heading-BxRgkUIs.js";import{b as X}from"./formOptions-DVbo6krV.js";import{e as Z}from"./projectAPI-CU9g8VHW.js";import{S as T,a as S,b as C,c as D,d as b}from"./select-BHLPfebz.js";import{D as Q}from"./data-table-skeleton-CuRl59V_.js";import{B as ee}from"./breadcrumbs-BBq-Aa_y.js";import"./index-CtFYXzGw.js";import"./scroll-area-BKreW2pl.js";import"./chevron-left-DaQQ12xE.js";import"./dialog-CF420k6p.js";import"./index-BxLXBVty.js";import"./Combination-C-ehu9Kp.js";import"./index-VWaDGczM.js";const se=({data:t})=>{const{role:o}=P(),l=w(),[i]=g.useState(!1),[p,r]=g.useState(!1),c=E(),a=async()=>{await $(t.id),r(!1),l("/todos"),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(L,{isOpen:p,onClose:()=>r(!1),onConfirm:a,loading:i}),e.jsxs(Y,{modal:!1,children:[e.jsx(O,{asChild:!0,children:e.jsxs(y,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(V,{className:"h-4 w-4"})]})}),e.jsxs(R,{align:"end",children:[e.jsx(z,{children:"Actions"}),e.jsxs(N,{onClick:()=>c.push(`/todos/details/${t.id}`),children:[e.jsx(U,{className:"mr-2 h-4 w-4"})," Details"]}),e.jsxs(N,{onClick:()=>c.push(`/todos/update/${t.id}`),children:[e.jsx(k,{className:"mr-2 h-4 w-4"})," Update"]}),o==="root"&&e.jsxs(N,{onClick:()=>r(!0),children:[e.jsx(G,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})]})},ae=[{accessorKey:"id",header:"ID"},{accessorKey:"Project_Name",header:"PROJECT"},{accessorKey:"Title",header:"TITLE"},{accessorKey:"Description",header:"DESCRIPTION"},{accessorKey:"Inhouse_Engineer",header:"ENGINEER"},{accessorKey:"Deadline",header:"DEADLINE"},{accessorKey:"Status",header:"STATUS"},{id:"actions",cell:({row:t})=>e.jsx(se,{data:t.original})}],re=n.object({Title:n.string({required_error:"Title required"}).min(1,{message:"title is should be at least 1 character"}),Description:n.string().optional(),Project_Id:n.string().optional(),Project_Name:n.string({required_error:"Project Name is required"}).min(1,{message:"title is should be at least 1 character"}),Inhouse_Engineer:n.string({required_error:"Engineer is required"}).min(1,{message:"title is should be at least 1 character"}),Status:n.string({required_error:"Status is required"}).min(1,{message:"Status should be at least 1 character"}),Deadline:n.string().refine(t=>/^\d{4}-\d{2}-\d{2}$/.test(t),{message:"Date should be in the format YYYY-MM-DD"})}),te=({modalClose:t})=>{const[o,l]=g.useState([]),[i,p]=g.useState([]),r=I({resolver:F(re),defaultValues:{}}),c=a=>{var s,d;a.Project_Id=(s=a==null?void 0:a.Project_Name)==null?void 0:s.split(",")[1],a.Project_Name=(d=a==null?void 0:a.Project_Name)==null?void 0:d.split(",")[0],H(a),window.location.reload()};return g.useEffect(()=>{(async()=>{const s=await A();l(s);const d=await Z();p(d)})()},[]),e.jsxs("div",{className:"px-2",children:[e.jsx(W,{title:"Create Todo",description:"",className:"space-y-2 py-8 text-center"}),e.jsx(_,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(c),className:"space-y-10",autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-x-4 gap-y-4",children:[e.jsx(m,{control:r.control,name:"Title",render:({field:a})=>e.jsxs(h,{children:[e.jsx(j,{children:"Title"}),e.jsx(x,{children:e.jsx(f,{placeholder:"Title",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(u,{})]})}),e.jsx(m,{control:r.control,name:"Description",render:({field:a})=>e.jsxs(h,{children:[e.jsx(j,{children:"Description"}),e.jsx(x,{children:e.jsx(f,{placeholder:"Description",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(u,{})]})})]}),e.jsxs("div",{className:" grid grid-cols-2 gap-x-8 gap-y-4",children:[e.jsx(m,{control:r.control,name:"Project_Name",render:({field:a})=>e.jsxs(h,{children:[e.jsx(j,{children:"Select Project"}),e.jsx(x,{children:e.jsxs(T,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(S,{children:e.jsx(C,{placeholder:"Select Project"})}),e.jsx(D,{children:i==null?void 0:i.map(s=>e.jsx(b,{value:(s==null?void 0:s.Project_Name)+","+(s==null?void 0:s.id),children:s==null?void 0:s.Project_Name},s==null?void 0:s.id))})]})}),e.jsx(u,{})]})}),e.jsx(m,{control:r.control,name:"Inhouse_Engineer",render:({field:a})=>e.jsxs(h,{children:[e.jsx(j,{children:"Assign Inhouse Engineer"}),e.jsx(x,{children:e.jsxs(T,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(S,{children:e.jsx(C,{placeholder:"Select Inhouse Engineer"})}),e.jsx(D,{children:o==null?void 0:o.map(s=>e.jsx(b,{value:s==null?void 0:s.username,children:s==null?void 0:s.full_name},s==null?void 0:s.id))})]})}),e.jsx(u,{})]})})]}),e.jsxs("div",{className:" grid grid-cols-2 gap-x-8 gap-y-4",children:[e.jsx(m,{control:r.control,name:"Deadline",render:({field:a})=>e.jsxs(h,{children:[e.jsx(j,{children:"Deadline"}),e.jsx(x,{children:e.jsx(f,{type:"date",...a})}),e.jsx(u,{})]})}),e.jsx(m,{control:r.control,name:"Status",render:({field:a})=>e.jsxs(h,{children:[e.jsx(j,{children:"Status"}),e.jsx(x,{children:e.jsxs(T,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(S,{children:e.jsx(C,{placeholder:"Status"})}),e.jsx(D,{children:X.map(s=>e.jsx(b,{value:s,children:s},s))})]})}),e.jsx(u,{})]})})]})]}),e.jsxs("div",{className:" flex items-center justify-center gap-4",children:[e.jsx(y,{type:"button",variant:"secondary",className:"rounded-full ",size:"lg",onClick:t,children:"Cancel"}),e.jsx(y,{type:"submit",className:"rounded-full",size:"lg",children:"Create Todo"})]})]})})]})},oe=te;function ne(){const{isAdmin:t}=P();return e.jsxs("div",{className:"flex items-center justify-between gap-2 py-5",children:[e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx(K,{placeholder:"Search Todos "})}),e.jsx("div",{className:"flex gap-3",children:t&&e.jsx(J,{title:"Todo",renderModal:o=>e.jsx(oe,{modalClose:o})})})]})}function ie({todos:t,pageCount:o}){return e.jsxs(e.Fragment,{children:[e.jsx(ne,{}),t&&e.jsx(B,{columns:ae,data:t,pageCount:o})]})}function _e(){const[t]=M(),o=Number(t.get("page")||1),l=Number(t.get("limit")||10),i=t.get("search")||null,p=(o-1)*l,{data:r,isLoading:c}=q(p,l,i),a=r==null?void 0:r.todos,s=r==null?void 0:r.totalTodos,d=r==null?void 0:r.pageCount;return c?e.jsx("div",{className:"p-5",children:e.jsx(Q,{columnCount:10,filterableColumnCount:2,searchableColumnCount:1})}):e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsx(v,{title:"Todo Management | YSEC"}),e.jsx("div",{className:"flex justify-between",children:e.jsx(ee,{items:[{title:"Dashboard",link:"/"},{title:"Todos",link:"/todos"}]})}),e.jsx(ie,{todos:a,page:o,totalTodos:s,pageCount:d})]})}export{_e as default};
