import{a3 as C,r as f,z as w,j as e,B as g,af as o,S as b,U as v,V as i,W as c,Y as d,I as x,Z as m,al as F,T as S,am as D,a4 as M}from"./index-BLqXuCnr.js";import{P as E}from"./page-head-VzjWYUDB.js";import{a as k,d as A,c as T}from"./clientAPI-Q2rU9GJU.js";import{u as _,D as P}from"./data-table-skeleton-CuRl59V_.js";import{E as I,S as q,T as B,D as $}from"./table-search-input--87h2RvB.js";import{A as K}from"./alert-modal-C9pp_1Di.js";import{D as z,a as H,b as L,c as O,f as u,B as R}from"./dropdown-menu-dHZaePSY.js";import{A as N,T as U}from"./auth-bzn4Wv-G.js";import{P as V}from"./popup-modal-z7OdiKKz.js";import{H as Y}from"./heading-BxRgkUIs.js";import{B as G}from"./breadcrumbs-BBq-Aa_y.js";import"./index-CtFYXzGw.js";import"./scroll-area-BKreW2pl.js";import"./select-BHLPfebz.js";import"./Combination-C-ehu9Kp.js";import"./chevron-left-DaQQ12xE.js";import"./dialog-CF420k6p.js";import"./index-BxLXBVty.js";import"./index-VWaDGczM.js";const Q=(s,l,r)=>_({queryKey:["clients",s,l,r],queryFn:async()=>k(s,l,r)}),W=({data:s})=>{const{role:l,isAdmin:r}=N(),p=C(),[a]=f.useState(!1),[n,t]=f.useState(!1),h=w(),j=async()=>{await A(s.id),t(!1),p("/clients"),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(K,{isOpen:n,onClose:()=>t(!1),onConfirm:j,loading:a}),e.jsxs(z,{modal:!1,children:[e.jsx(H,{asChild:!0,children:e.jsxs(g,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(I,{className:"h-4 w-4"})]})}),e.jsxs(L,{align:"end",children:[e.jsx(O,{children:"Actions"}),e.jsxs(u,{onClick:()=>h.push(`/client/details/${s.id}`),children:[e.jsx(R,{className:"mr-2 h-4 w-4"})," Details"]}),r&&e.jsxs(u,{onClick:()=>h.push(`/client/update/${s.id}`),children:[e.jsx(q,{className:"mr-2 h-4 w-4"})," Update"]}),l==="root"&&e.jsxs(u,{onClick:()=>t(!0),children:[e.jsx(U,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})]})},Z=[{accessorKey:"id",header:"ID"},{accessorFn:s=>`${s.first_name} ${s.middle_name} ${s.last_name}`.trim(),id:"full_name",header:"NAME"},{accessorKey:"firm",header:"FIRM"},{accessorKey:"email",header:"EMAIL"},{accessorKey:"phone",header:"PHONE"},{id:"actions",cell:({row:s})=>e.jsx(W,{data:s.original})}],J=o.object({first_name:o.string({required_error:"First name is required"}).min(1,{message:"firstname is should be at least 1 character"}),middle_name:o.string().optional(),last_name:o.string().min(1,{message:"lastname is required"}),location:o.string().optional(),firm:o.string().optional(),email:o.string().optional(),phone:o.string().optional(),remarks:o.string().optional()}),X=({modalClose:s})=>{const l=C(),r=b({resolver:S(J),defaultValues:{}}),p=async a=>{var t;const n=await T(a);(n==null?void 0:n.status)===201&&(console.log(n==null?void 0:n.data),D({title:(t=n==null?void 0:n.data)==null?void 0:t.message,description:"Project Created Successfully!"})),s(),l("/clients"),window.location.reload()};return e.jsxs("div",{className:"px-2",children:[e.jsx(Y,{title:"Create New Client",description:"",className:"space-y-2 py-10 text-center"}),e.jsx(v,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(p),className:"space-y-12",autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 gap-y-4",children:[e.jsx(i,{control:r.control,name:"first_name",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Firstname",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"middle_name",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Middlename",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"last_name",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Lastname",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})})]}),e.jsxs("div",{className:" grid grid-cols-2 gap-x-8 gap-y-4",children:[e.jsx(i,{control:r.control,name:"email",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Enter email",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"phone",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Enter phone",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"firm",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Enter firm",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"location",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Enter location",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-x-8 gap-y-4",children:e.jsx(i,{control:r.control,name:"remarks",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(F,{placeholder:"Enter remarks",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})})})]}),e.jsxs("div",{className:" flex items-center justify-center gap-4",children:[e.jsx(g,{type:"button",variant:"secondary",className:"rounded-full ",size:"lg",onClick:s,children:"Cancel"}),e.jsx(g,{type:"submit",className:"rounded-full",size:"lg",children:"Create Client"})]})]})})]})},ee=X;function se(){const{isAdmin:s}=N();return e.jsxs("div",{className:"flex items-center justify-between gap-2 py-5",children:[e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx(B,{placeholder:"Search Clients "})}),e.jsx("div",{className:"flex gap-3",children:s&&e.jsx(V,{title:"Client",renderModal:l=>e.jsx(ee,{modalClose:l})})})]})}function ae({clients:s,pageCount:l}){return e.jsxs(e.Fragment,{children:[e.jsx(se,{}),s&&e.jsx($,{columns:Z,data:s,pageCount:l})]})}function we(){const[s]=M(),l=Number(s.get("page")||1),r=Number(s.get("limit")||10),p=s.get("search")||null,a=(l-1)*r,{data:n,isLoading:t}=Q(a,r,p),h=n==null?void 0:n.clients,j=n==null?void 0:n.totalClients,y=n==null?void 0:n.pageCount;return t?e.jsx("div",{className:"p-5",children:e.jsx(P,{columnCount:10,filterableColumnCount:2,searchableColumnCount:1})}):e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsx(E,{title:"Client Management | YSEC"}),e.jsx("div",{className:"flex justify-between",children:e.jsx(G,{items:[{title:"Dashboard",link:"/"},{title:"Clients",link:"/clients"}]})}),e.jsx(ae,{clients:h,page:l,totalClients:j,pageCount:y})]})}export{we as default};
