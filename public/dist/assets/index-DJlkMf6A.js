import{J as w,r as g,t as E,j as e,B as y,U as n,v as I,F as _,x as m,y as h,z as j,A as x,I as f,D as u,w as F,K as A}from"./index-BirjyYCK.js";import{P as v}from"./page-head-B-yQEvVP.js";import{u as M}from"./queries-Bs4c0VQ7.js";import{E as q,S as k,T as K,D as V}from"./table-search-input-DGMh2Okc.js";import{A as B}from"./alert-modal-cwZN9oy5.js";import{D as L,a as O,b as R,c as Y,f as N,B as z}from"./dropdown-menu-CXTQN6EL.js";import{d as U,c as $}from"./todoAPI-C5CE0O1H.js";import{A as P,T as H}from"./auth-fuJk9yB2.js";import{P as G}from"./popup-modal-DAWeHeJ-.js";import{H as J}from"./heading-BrIWLUOq.js";import{b as Q}from"./formOptions-DVbo6krV.js";import{g as W}from"./api-BsWGTiFV.js";import{e as X}from"./projectAPI-Ckeg2yN0.js";import{S as T,a as S,b as C,c as D,d as b}from"./select-Cu7ZoTPv.js";import{D as Z}from"./data-table-skeleton-Ds5_A7jR.js";import{B as ee}from"./breadcrumbs-Db9tqQQQ.js";import"./index-j3Cmd6QT.js";import"./scroll-area-BMuCLgJC.js";import"./chevron-left-NGMl8fvv.js";import"./index-Cb5npXBK.js";import"./Combination-DFHS0Xp4.js";import"./index-VWaDGczM.js";const se=({data:t})=>{const{role:o}=P(),l=w(),[i]=g.useState(!1),[p,a]=g.useState(!1),c=E(),r=async()=>{await U(t.id),a(!1),l("/todos"),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(B,{isOpen:p,onClose:()=>a(!1),onConfirm:r,loading:i}),e.jsxs(L,{modal:!1,children:[e.jsx(O,{asChild:!0,children:e.jsxs(y,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(q,{className:"h-4 w-4"})]})}),e.jsxs(R,{align:"end",children:[e.jsx(Y,{children:"Actions"}),e.jsxs(N,{onClick:()=>c.push(`/todos/details/${t.id}`),children:[e.jsx(z,{className:"mr-2 h-4 w-4"})," Details"]}),e.jsxs(N,{onClick:()=>c.push(`/todos/update/${t.id}`),children:[e.jsx(k,{className:"mr-2 h-4 w-4"})," Update"]}),o==="root"&&e.jsxs(N,{onClick:()=>a(!0),children:[e.jsx(H,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})]})},re=[{accessorKey:"id",header:"ID"},{accessorKey:"Project_Name",header:"PROJECT"},{accessorKey:"Title",header:"TITLE"},{accessorKey:"Description",header:"DESCRIPTION"},{accessorKey:"Inhouse_Engineer",header:"ENGINEER"},{accessorKey:"Deadline",header:"DEADLINE"},{accessorKey:"Status",header:"STATUS"},{id:"actions",cell:({row:t})=>e.jsx(se,{data:t.original})}],ae=n.object({Title:n.string({required_error:"Title required"}).min(1,{message:"title is should be at least 1 character"}),Description:n.string().optional(),Project_Id:n.string().optional(),Project_Name:n.string({required_error:"Project Name is required"}).min(1,{message:"title is should be at least 1 character"}),Inhouse_Engineer:n.string({required_error:"Engineer is required"}).min(1,{message:"title is should be at least 1 character"}),Status:n.string({required_error:"Status is required"}).min(1,{message:"Status should be at least 1 character"}),Deadline:n.string().refine(t=>/^\d{4}-\d{2}-\d{2}$/.test(t),{message:"Date should be in the format YYYY-MM-DD"})}),te=({modalClose:t})=>{const[o,l]=g.useState([]),[i,p]=g.useState([]),a=I({resolver:F(ae),defaultValues:{}}),c=r=>{var s,d;r.Project_Id=(s=r==null?void 0:r.Project_Name)==null?void 0:s.split(",")[1],r.Project_Name=(d=r==null?void 0:r.Project_Name)==null?void 0:d.split(",")[0],$(r),window.location.reload()};return g.useEffect(()=>{(async()=>{const s=await W();l(s);const d=await X();p(d)})()},[]),e.jsxs("div",{className:"px-2",children:[e.jsx(J,{title:"Create Todo",description:"",className:"space-y-2 py-8 text-center"}),e.jsx(_,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(c),className:"space-y-10",autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-x-4 gap-y-4",children:[e.jsx(m,{control:a.control,name:"Title",render:({field:r})=>e.jsxs(h,{children:[e.jsx(j,{children:"Title"}),e.jsx(x,{children:e.jsx(f,{placeholder:"Title",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(u,{})]})}),e.jsx(m,{control:a.control,name:"Description",render:({field:r})=>e.jsxs(h,{children:[e.jsx(j,{children:"Description"}),e.jsx(x,{children:e.jsx(f,{placeholder:"Description",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(u,{})]})})]}),e.jsxs("div",{className:" grid grid-cols-2 gap-x-8 gap-y-4",children:[e.jsx(m,{control:a.control,name:"Project_Name",render:({field:r})=>e.jsxs(h,{children:[e.jsx(j,{children:"Select Project"}),e.jsx(x,{children:e.jsxs(T,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(S,{children:e.jsx(C,{placeholder:"Select Project"})}),e.jsx(D,{children:i==null?void 0:i.map(s=>e.jsx(b,{value:(s==null?void 0:s.Project_Name)+","+(s==null?void 0:s.id),children:s==null?void 0:s.Project_Name},s==null?void 0:s.id))})]})}),e.jsx(u,{})]})}),e.jsx(m,{control:a.control,name:"Inhouse_Engineer",render:({field:r})=>e.jsxs(h,{children:[e.jsx(j,{children:"Assign Inhouse Engineer"}),e.jsx(x,{children:e.jsxs(T,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(S,{children:e.jsx(C,{placeholder:"Select Inhouse Engineer"})}),e.jsx(D,{children:o==null?void 0:o.map(s=>e.jsx(b,{value:s==null?void 0:s.username,children:s==null?void 0:s.full_name},s==null?void 0:s.id))})]})}),e.jsx(u,{})]})})]}),e.jsxs("div",{className:" grid grid-cols-2 gap-x-8 gap-y-4",children:[e.jsx(m,{control:a.control,name:"Deadline",render:({field:r})=>e.jsxs(h,{children:[e.jsx(j,{children:"Deadline"}),e.jsx(x,{children:e.jsx(f,{type:"date",...r})}),e.jsx(u,{})]})}),e.jsx(m,{control:a.control,name:"Status",render:({field:r})=>e.jsxs(h,{children:[e.jsx(j,{children:"Status"}),e.jsx(x,{children:e.jsxs(T,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(S,{children:e.jsx(C,{placeholder:"Status"})}),e.jsx(D,{children:Q.map(s=>e.jsx(b,{value:s,children:s},s))})]})}),e.jsx(u,{})]})})]})]}),e.jsxs("div",{className:" flex items-center justify-center gap-4",children:[e.jsx(y,{type:"button",variant:"secondary",className:"rounded-full ",size:"lg",onClick:t,children:"Cancel"}),e.jsx(y,{type:"submit",className:"rounded-full",size:"lg",children:"Create Todo"})]})]})})]})},oe=te;function ne(){const{isAdmin:t}=P();return e.jsxs("div",{className:"flex items-center justify-between gap-2 py-5",children:[e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx(K,{placeholder:"Search Todos "})}),e.jsx("div",{className:"flex gap-3",children:t&&e.jsx(G,{title:"Todo",renderModal:o=>e.jsx(oe,{modalClose:o})})})]})}function ie({todos:t,pageCount:o}){return e.jsxs(e.Fragment,{children:[e.jsx(ne,{}),t&&e.jsx(V,{columns:re,data:t,pageCount:o})]})}function _e(){const[t]=A(),o=Number(t.get("page")||1),l=Number(t.get("limit")||10),i=t.get("search")||null,p=(o-1)*l,{data:a,isLoading:c}=M(p,l,i),r=a==null?void 0:a.todos,s=a==null?void 0:a.totalTodos,d=a==null?void 0:a.pageCount;return c?e.jsx("div",{className:"p-5",children:e.jsx(Z,{columnCount:10,filterableColumnCount:2,searchableColumnCount:1})}):e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsx(v,{title:"Todo Management | YSEC"}),e.jsx("div",{className:"flex justify-between",children:e.jsx(ee,{items:[{title:"Dashboard",link:"/"},{title:"Todos",link:"/todos"}]})}),e.jsx(ie,{todos:r,page:o,totalTodos:s,pageCount:d})]})}export{_e as default};
