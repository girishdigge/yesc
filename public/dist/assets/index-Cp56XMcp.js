import{J as C,r as f,t as w,j as e,B as g,U as l,v as b,F as v,x as i,y as c,A as d,I as x,D as m,w as F,W as D,K as M}from"./index-6H5e9l0w.js";import{P as S}from"./page-head-B0EnvZ9D.js";import{a as E,d as A,c as k}from"./clientAPI-SqdqiAKW.js";import{u as T,D as _}from"./data-table-skeleton-CuYFPzGc.js";import{E as P,S as I,T as q,D as B}from"./table-search-input-8_KdIp39.js";import{A as K}from"./alert-modal-DN6UPIyx.js";import{D as $,a as H,b as L,c as O,f as u,B as z}from"./dropdown-menu-CJ9YM51G.js";import{A as y,T as R}from"./auth-BpkhzL83.js";import{P as U}from"./popup-modal-B7ZPiJCs.js";import{H as G}from"./heading-D2ik8sFW.js";import{T as J}from"./textarea-xPDPw3J5.js";import{B as Q}from"./breadcrumbs-CyY4bF2v.js";import"./api-BsWGTiFV.js";import"./index-CMynADOj.js";import"./scroll-area-u-nMwbqL.js";import"./select-Bt0UfSwl.js";import"./Combination-yR-ZI2dk.js";import"./chevron-left-Dn4d5UMm.js";import"./index-DgI5qclv.js";import"./index-VWaDGczM.js";const V=(s,o,r)=>T({queryKey:["clients",s,o,r],queryFn:async()=>E(s,o,r)}),W=({data:s})=>{const{role:o,isAdmin:r}=y(),p=C(),[a]=f.useState(!1),[n,t]=f.useState(!1),h=w(),j=async()=>{await A(s.id),t(!1),p("/clients"),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(K,{isOpen:n,onClose:()=>t(!1),onConfirm:j,loading:a}),e.jsxs($,{modal:!1,children:[e.jsx(H,{asChild:!0,children:e.jsxs(g,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(P,{className:"h-4 w-4"})]})}),e.jsxs(L,{align:"end",children:[e.jsx(O,{children:"Actions"}),e.jsxs(u,{onClick:()=>h.push(`/client/details/${s.id}`),children:[e.jsx(z,{className:"mr-2 h-4 w-4"})," Details"]}),r&&e.jsxs(u,{onClick:()=>h.push(`/client/update/${s.id}`),children:[e.jsx(I,{className:"mr-2 h-4 w-4"})," Update"]}),o==="root"&&e.jsxs(u,{onClick:()=>t(!0),children:[e.jsx(R,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})]})},Y=[{accessorKey:"id",header:"ID"},{accessorFn:s=>`${s.first_name} ${s.middle_name} ${s.last_name}`.trim(),id:"full_name",header:"NAME"},{accessorKey:"firm",header:"FIRM"},{accessorKey:"email",header:"EMAIL"},{accessorKey:"phone",header:"PHONE"},{id:"actions",cell:({row:s})=>e.jsx(W,{data:s.original})}],X=l.object({first_name:l.string({required_error:"First name is required"}).min(1,{message:"firstname is should be at least 1 character"}),middle_name:l.string().optional(),last_name:l.string().min(1,{message:"lastname is required"}),location:l.string().optional(),firm:l.string().optional(),email:l.string().optional(),phone:l.string().optional(),remarks:l.string().optional()}),Z=({modalClose:s})=>{const o=C(),r=b({resolver:F(X),defaultValues:{}}),p=async a=>{var t;const n=await k(a);(n==null?void 0:n.status)===201&&(console.log(n==null?void 0:n.data),D({title:(t=n==null?void 0:n.data)==null?void 0:t.message,description:"Project Created Successfully!"})),s(),o("/clients"),window.location.reload()};return e.jsxs("div",{className:"px-2",children:[e.jsx(G,{title:"Create New Client",description:"",className:"space-y-2 py-10 text-center"}),e.jsx(v,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(p),className:"space-y-12",autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 gap-y-4",children:[e.jsx(i,{control:r.control,name:"first_name",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Firstname",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"middle_name",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Middlename",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"last_name",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Lastname",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})})]}),e.jsxs("div",{className:" grid grid-cols-2 gap-x-8 gap-y-4",children:[e.jsx(i,{control:r.control,name:"email",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Enter email",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"phone",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Enter phone",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"firm",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Enter firm",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"location",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(x,{placeholder:"Enter location",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-x-8 gap-y-4",children:e.jsx(i,{control:r.control,name:"remarks",render:({field:a})=>e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(J,{placeholder:"Enter remarks",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})})})]}),e.jsxs("div",{className:" flex items-center justify-center gap-4",children:[e.jsx(g,{type:"button",variant:"secondary",className:"rounded-full ",size:"lg",onClick:s,children:"Cancel"}),e.jsx(g,{type:"submit",className:"rounded-full",size:"lg",children:"Create Client"})]})]})})]})},ee=Z;function se(){const{isAdmin:s}=y();return e.jsxs("div",{className:"flex items-center justify-between gap-2 py-5",children:[e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx(q,{placeholder:"Search Clients "})}),e.jsx("div",{className:"flex gap-3",children:s&&e.jsx(U,{title:"Client",renderModal:o=>e.jsx(ee,{modalClose:o})})})]})}function ae({clients:s,pageCount:o}){return e.jsxs(e.Fragment,{children:[e.jsx(se,{}),s&&e.jsx(B,{columns:Y,data:s,pageCount:o})]})}function be(){const[s]=M(),o=Number(s.get("page")||1),r=Number(s.get("limit")||10),p=s.get("search")||null,a=(o-1)*r,{data:n,isLoading:t}=V(a,r,p),h=n==null?void 0:n.clients,j=n==null?void 0:n.totalClients,N=n==null?void 0:n.pageCount;return t?e.jsx("div",{className:"p-5",children:e.jsx(_,{columnCount:10,filterableColumnCount:2,searchableColumnCount:1})}):e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsx(S,{title:"Client Management | YSEC"}),e.jsx("div",{className:"flex justify-between",children:e.jsx(Q,{items:[{title:"Dashboard",link:"/"},{title:"Clients",link:"/clients"}]})}),e.jsx(ae,{clients:h,page:o,totalClients:j,pageCount:N})]})}export{be as default};
