import{ad as C,a3 as w,r as f,z as b,j as e,B as y,ae as S,af as l,S as v,U as F,V as i,W as t,Y as c,I as d,Z as m,T as P,ag as D,a4 as M}from"./index-BLqXuCnr.js";import{P as A}from"./page-head-VzjWYUDB.js";import{u as q,D as T}from"./data-table-skeleton-CuRl59V_.js";import{E as _,S as k,T as I,D as B}from"./table-search-input--87h2RvB.js";import{A as L}from"./alert-modal-C9pp_1Di.js";import{D as $,a as K,b as O,c as V,f as u,B as z}from"./dropdown-menu-dHZaePSY.js";import{A as N,T as H}from"./auth-bzn4Wv-G.js";import{P as R}from"./popup-modal-z7OdiKKz.js";import{H as U}from"./heading-BxRgkUIs.js";import{S as G,a as Y,b as Q,c as W,e as Z,f as J,d as g}from"./select-BHLPfebz.js";import{B as X}from"./breadcrumbs-BBq-Aa_y.js";import"./index-CtFYXzGw.js";import"./scroll-area-BKreW2pl.js";import"./chevron-left-DaQQ12xE.js";import"./dialog-CF420k6p.js";import"./index-BxLXBVty.js";import"./Combination-C-ehu9Kp.js";import"./index-VWaDGczM.js";const ee=(s,n,r)=>q({queryKey:["employees",s,n,r],queryFn:async()=>C(s,n,r)}),se=({data:s})=>{const{role:n,isAdmin:r}=N(),p=w(),[a]=f.useState(!1),[o,x]=f.useState(!1),h=b(),j=async()=>{await S(s.id),x(!1),p("/employee"),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(L,{isOpen:o,onClose:()=>x(!1),onConfirm:j,loading:a}),e.jsxs($,{modal:!1,children:[e.jsx(K,{asChild:!0,children:e.jsxs(y,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(_,{className:"h-4 w-4"})]})}),e.jsxs(O,{align:"end",children:[e.jsx(V,{children:"Actions"}),e.jsxs(u,{onClick:()=>h.push(`/employee/details/${s.id}`),children:[e.jsx(z,{className:"mr-2 h-4 w-4"})," Details"]}),r&&e.jsxs(u,{onClick:()=>h.push(`/employee/update/${s.id}`),children:[e.jsx(k,{className:"mr-2 h-4 w-4"})," Update"]}),n==="root"&&e.jsxs(u,{onClick:()=>x(!0),children:[e.jsx(H,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})]})},ae=[{accessorKey:"username",header:"ID"},{accessorFn:s=>`${s.first_name} ${s.middle_name} ${s.last_name}`.trim(),id:"full_name",header:"NAME"},{accessorKey:"role",header:"ROLE"},{accessorKey:"email",header:"EMAIL"},{accessorKey:"phone",header:"PHONE"},{id:"actions",cell:({row:s})=>e.jsx(se,{data:s.original})}],re=l.object({first_name:l.string({required_error:"First name is required"}).min(1,{message:"firstname is should be at least 1 character"}),middle_name:l.string().min(1,{message:"middlename is required"}),last_name:l.string().min(1,{message:"lastname is required"}),username:l.string().min(1,{message:"username is required"}),role:l.string().min(1,{message:"role is required"}),email:l.string().email({message:"Enter a valid email address"}),phone:l.string().min(10,{message:"Enter a valid phone number"}),password:l.string().min(1,{message:"Password is required"}),confirmPassword:l.string().min(1,{message:"Confirm Password is required"})}).refine(s=>s.password===s.confirmPassword,{message:"Passwords must match",path:["confirmPassword"]}),ne=({modalClose:s})=>{const n=w(),r=v({resolver:P(re),defaultValues:{}}),p=a=>{D(a),s(),n("/employee"),window.location.reload()};return e.jsxs("div",{className:"px-2",children:[e.jsx(U,{title:"Create New Employee",description:"",className:"space-y-2 py-10 text-center"}),e.jsx(F,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(p),className:"space-y-12",autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 gap-y-4",children:[e.jsx(i,{control:r.control,name:"first_name",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Firstname",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"middle_name",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Middlename",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"last_name",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Lastname",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})})]}),e.jsxs("div",{className:" grid grid-cols-2 gap-x-8 gap-y-4",children:[e.jsx(i,{control:r.control,name:"username",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Enter username",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"role",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsxs(G,{onValueChange:o=>a.onChange(o),defaultValue:a.value,children:[e.jsx(Y,{className:"w-full px-4 py-6 shadow-inner drop-shadow-xl",children:e.jsx(Q,{placeholder:"Select Role"})}),e.jsx(W,{children:e.jsxs(Z,{children:[e.jsx(J,{children:"Designation"}),e.jsx(g,{value:"engineer",children:"Engineer"}),e.jsx(g,{value:"senior",children:"Senior"}),e.jsx(g,{value:"admin",children:"Admin"})]})})]})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"email",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Enter email",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"phone",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Enter phone",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"password",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Create password",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})}),e.jsx(i,{control:r.control,name:"confirmPassword",render:({field:a})=>e.jsxs(t,{children:[e.jsx(c,{children:e.jsx(d,{placeholder:"Confirm password",...a,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(m,{})]})})]})]}),e.jsxs("div",{className:" flex items-center justify-center gap-4",children:[e.jsx(y,{type:"button",variant:"secondary",className:"rounded-full ",size:"lg",onClick:s,children:"Cancel"}),e.jsx(y,{type:"submit",className:"rounded-full",size:"lg",children:"Create Employee"})]})]})})]})},oe=ne;function le(){const{isAdmin:s}=N();return e.jsxs("div",{className:"flex items-center justify-between gap-2 py-5",children:[e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx(I,{placeholder:"Search Employees "})}),e.jsx("div",{className:"flex gap-3",children:s&&e.jsx(R,{title:"Employee",renderModal:n=>e.jsx(oe,{modalClose:n})})})]})}function ie({employees:s,pageCount:n}){return e.jsxs(e.Fragment,{children:[e.jsx(le,{}),s&&e.jsx(B,{columns:ae,data:s,pageCount:n})]})}function ve(){const[s]=M(),n=Number(s.get("page")||1),r=Number(s.get("limit")||10),p=s.get("search")||null,a=(n-1)*r,{data:o,isLoading:x}=ee(a,r,p),h=o==null?void 0:o.employees,j=o==null?void 0:o.totalEmployees,E=o==null?void 0:o.pageCount;return x?e.jsx("div",{className:"p-5",children:e.jsx(T,{columnCount:10,filterableColumnCount:2,searchableColumnCount:1})}):e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsx(A,{title:"Employee Management | YSEC"}),e.jsx("div",{className:"flex justify-between",children:e.jsx(X,{items:[{title:"Dashboard",link:"/"},{title:"Employees",link:"/employees"}]})}),e.jsx(ie,{employees:h,page:n,totalEmployees:j,pageCount:E})]})}export{ve as default};
