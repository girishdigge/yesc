import{J as w,r as p,t as E,j as e,B as y,Q as n,v as P,F as I,x as c,y as d,z as m,A as h,I as f,D as u,w as F,K as A}from"./index-BHqYEVpr.js";import{P as _}from"./page-head-DnRIryst.js";import{u as M}from"./queries-CJ8mnbUb.js";import{E as q,S as k,T as K,D as V}from"./table-search-input-OFx9dtpd.js";import{A as B}from"./alert-modal-BbSlZVHF.js";import{A as v,D as L,a as O,b as R,c as Y,f as T,B as z}from"./dropdown-menu-B2q1b40F.js";import{d as $,c as H}from"./todoAPI-DtW74Z3t.js";import{T as U}from"./trash-Cqpd8zjW.js";import{P as G}from"./popup-modal-C7Hv1q3z.js";import{H as J}from"./heading-DLKN7QJX.js";import{b as Q}from"./formOptions-DVbo6krV.js";import{g as W}from"./api-fvz03lhi.js";import{e as X}from"./projectAPI-Ct98bTuH.js";import{S as N,a as S,b as C,c as D,d as b}from"./select-DFVNYac5.js";import{D as Z}from"./data-table-skeleton-CmbjhmVS.js";import{B as ee}from"./breadcrumbs-CxWpwQan.js";import"./index-BiMNKS6m.js";import"./scroll-area-Kh0p6MKS.js";import"./chevron-left-DTSZ-l0x.js";import"./index-KnQW5NRs.js";import"./Combination-C5Dgzbfj.js";import"./index-VWaDGczM.js";import"./axios-Cm0UX6qg.js";const se=({data:o})=>{const{role:t}=v(),l=w(),[x]=p.useState(!1),[j,a]=p.useState(!1),i=E(),r=async()=>{await $(o.id),a(!1),l("/todos"),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(B,{isOpen:j,onClose:()=>a(!1),onConfirm:r,loading:x}),e.jsxs(L,{modal:!1,children:[e.jsx(O,{asChild:!0,children:e.jsxs(y,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(q,{className:"h-4 w-4"})]})}),e.jsxs(R,{align:"end",children:[e.jsx(Y,{children:"Actions"}),e.jsxs(T,{onClick:()=>i.push(`/todos/details/${o.id}`),children:[e.jsx(z,{className:"mr-2 h-4 w-4"})," Details"]}),e.jsxs(T,{onClick:()=>i.push(`/todos/update/${o.id}`),children:[e.jsx(k,{className:"mr-2 h-4 w-4"})," Update"]}),t==="root"&&e.jsxs(T,{onClick:()=>a(!0),children:[e.jsx(U,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})]})},ae=[{accessorKey:"id",header:"ID"},{accessorKey:"Project_Name",header:"PROJECT"},{accessorKey:"Title",header:"TITLE"},{accessorKey:"Description",header:"DESCRIPTION"},{accessorKey:"Inhouse_Engineer",header:"ENGINEER"},{accessorKey:"Deadline",header:"DEADLINE"},{accessorKey:"Status",header:"STATUS"},{id:"actions",cell:({row:o})=>e.jsx(se,{data:o.original})}],re=n.object({Title:n.string({required_error:"Title required"}).min(1,{message:"title is should be at least 1 character"}),Description:n.string().optional(),Project_Name:n.string({required_error:"Project Name is required"}).min(1,{message:"title is should be at least 1 character"}),Inhouse_Engineer:n.string({required_error:"Engineer is required"}).min(1,{message:"title is should be at least 1 character"}),Status:n.string({required_error:"Status is required"}).min(1,{message:"Status should be at least 1 character"}),Deadline:n.string().refine(o=>/^\d{4}-\d{2}-\d{2}$/.test(o),{message:"Date should be in the format YYYY-MM-DD"})}),oe=({modalClose:o})=>{const[t,l]=p.useState([]),[x,j]=p.useState([]),a=P({resolver:F(re),defaultValues:{}}),i=r=>{H(r),window.location.reload()};return p.useEffect(()=>{(async()=>{const s=await W();l(s);const g=await X();j(g)})()},[]),e.jsxs("div",{className:"px-2",children:[e.jsx(J,{title:"Create Todo",description:"",className:"space-y-2 py-8 text-center"}),e.jsx(I,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(i),className:"space-y-10",autoComplete:"off",children:[e.jsxs("div",{className:"grid gap-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-x-4 gap-y-4",children:[e.jsx(c,{control:a.control,name:"Title",render:({field:r})=>e.jsxs(d,{children:[e.jsx(m,{children:"Title"}),e.jsx(h,{children:e.jsx(f,{placeholder:"Title",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(u,{})]})}),e.jsx(c,{control:a.control,name:"Description",render:({field:r})=>e.jsxs(d,{children:[e.jsx(m,{children:"Description"}),e.jsx(h,{children:e.jsx(f,{placeholder:"Description",...r,className:" px-4 py-6 shadow-inner drop-shadow-xl"})}),e.jsx(u,{})]})})]}),e.jsxs("div",{className:" grid grid-cols-2 gap-x-8 gap-y-4",children:[e.jsx(c,{control:a.control,name:"Project_Name",render:({field:r})=>e.jsxs(d,{children:[e.jsx(m,{children:"Select Project"}),e.jsx(h,{children:e.jsxs(N,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(S,{children:e.jsx(C,{placeholder:"Select Project"})}),e.jsx(D,{children:x.map(s=>e.jsx(b,{value:s==null?void 0:s.Project_Name,children:s==null?void 0:s.Project_Name},s==null?void 0:s.id))})]})}),e.jsx(u,{})]})}),e.jsx(c,{control:a.control,name:"Inhouse_Engineer",render:({field:r})=>e.jsxs(d,{children:[e.jsx(m,{children:"Assign Inhouse Engineer"}),e.jsx(h,{children:e.jsxs(N,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(S,{children:e.jsx(C,{placeholder:"Select Inhouse Engineer"})}),e.jsx(D,{children:t.map(s=>e.jsx(b,{value:s==null?void 0:s.username,children:s==null?void 0:s.full_name},s==null?void 0:s.id))})]})}),e.jsx(u,{})]})})]}),e.jsxs("div",{className:" grid grid-cols-2 gap-x-8 gap-y-4",children:[e.jsx(c,{control:a.control,name:"Deadline",render:({field:r})=>e.jsxs(d,{children:[e.jsx(m,{children:"Deadline"}),e.jsx(h,{children:e.jsx(f,{type:"date",...r})}),e.jsx(u,{})]})}),e.jsx(c,{control:a.control,name:"Status",render:({field:r})=>e.jsxs(d,{children:[e.jsx(m,{children:"Status"}),e.jsx(h,{children:e.jsxs(N,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(S,{children:e.jsx(C,{placeholder:"Status"})}),e.jsx(D,{children:Q.map(s=>e.jsx(b,{value:s,children:s},s))})]})}),e.jsx(u,{})]})})]})]}),e.jsxs("div",{className:" flex items-center justify-center gap-4",children:[e.jsx(y,{type:"button",variant:"secondary",className:"rounded-full ",size:"lg",onClick:o,children:"Cancel"}),e.jsx(y,{type:"submit",className:"rounded-full",size:"lg",children:"Create Todo"})]})]})})]})},te=oe;function ne(){const{isAdmin:o}=v();return e.jsxs("div",{className:"flex items-center justify-between gap-2 py-5",children:[e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx(K,{placeholder:"Search Todos "})}),e.jsx("div",{className:"flex gap-3",children:o&&e.jsx(G,{title:"Todo",renderModal:t=>e.jsx(te,{modalClose:t})})})]})}function le({todos:o,pageCount:t}){return e.jsxs(e.Fragment,{children:[e.jsx(ne,{}),o&&e.jsx(V,{columns:ae,data:o,pageCount:t})]})}function Fe(){const[o]=A(),t=Number(o.get("page")||1),l=Number(o.get("limit")||10),x=o.get("search")||null,j=(t-1)*l,{data:a,isLoading:i}=M(j,l,x),r=a==null?void 0:a.todos,s=a==null?void 0:a.totalTodos,g=a==null?void 0:a.pageCount;return i?e.jsx("div",{className:"p-5",children:e.jsx(Z,{columnCount:10,filterableColumnCount:2,searchableColumnCount:1})}):e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsx(_,{title:"Todo Management | YSEC"}),e.jsx("div",{className:"flex justify-between",children:e.jsx(ee,{items:[{title:"Dashboard",link:"/"},{title:"Todos",link:"/todos"}]})}),e.jsx(le,{todos:r,page:t,totalTodos:s,pageCount:g})]})}export{Fe as default};
