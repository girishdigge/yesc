import{a3 as f,r as p,z as d,j as e,B as h,a4 as P}from"./index-DIcS40jd.js";import{P as y}from"./page-head-Dluxbmkk.js";import{a as N,d as C}from"./projectAPI-kcs8BLOO.js";import{u as A,D as b}from"./data-table-skeleton-BrORegni.js";import{E as D,S,T,D as w}from"./table-search-input-Dh8wyM75.js";import{A as E}from"./alert-modal-k4EI7F0W.js";import{D as v,a as B,b as _,c as I,f as u,B as K,P as O}from"./dropdown-menu-Bdmw9SBL.js";import{A as x,T as k}from"./auth-BlBgYvq9.js";import{B as M}from"./breadcrumbs-BalubsiJ.js";import"./index-D3WTB7gC.js";import"./scroll-area-CZdIeNSX.js";import"./select-PErHbfmX.js";import"./Combination-CcrjQx5z.js";import"./chevron-left-ZwcPHqCb.js";import"./dialog-sOsU102b.js";import"./index-CM_goT24.js";import"./index-VWaDGczM.js";const R=localStorage.getItem("username")||"",J=localStorage.getItem("role")||"",L=(s,o,a)=>A({queryKey:["projects",s,o,a],queryFn:async()=>N(s,o,a,R,J)}),G=({data:s})=>{const{role:o,isAdmin:a}=x(),i=f(),[l]=p.useState(!1),[r,c]=p.useState(!1),n=d(),m=async()=>{await C(s.id),c(!1),i("/projects"),window.location.reload()};return e.jsxs(e.Fragment,{children:[e.jsx(E,{isOpen:r,onClose:()=>c(!1),onConfirm:m,loading:l}),e.jsxs(v,{modal:!1,children:[e.jsx(B,{asChild:!0,children:e.jsxs(h,{variant:"ghost",className:"h-8 w-8 p-0",children:[e.jsx("span",{className:"sr-only",children:"Open menu"}),e.jsx(D,{className:"h-4 w-4"})]})}),e.jsxs(_,{align:"end",children:[e.jsx(I,{children:"Actions"}),e.jsxs(u,{onClick:()=>n.push(`/project/details/${s.id}`),children:[e.jsx(K,{className:"mr-2 h-4 w-4"})," Details"]}),a&&e.jsxs(u,{onClick:()=>n.push(`/project/edit/${s.id}`),children:[e.jsx(S,{className:"mr-2 h-4 w-4"})," Edit Project"]}),o==="root"&&e.jsxs(u,{onClick:()=>c(!0),children:[e.jsx(k,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})]})},U=[{accessorKey:"id",header:"ID"},{accessorKey:"Project_Name",header:"PROJECT"},{accessorKey:"Project_Job_Category",header:"CATEGORY"},{accessorKey:"Project_Job_Number",header:"JOB NO."},{accessorKey:"Inhouse_Engineer",header:"ENGINEER ALLOTED"},{accessorKey:"Project_Status",header:"PROJECT STATUS"},{accessorKey:"Building_Status",header:"BUILDING STATUS"},{accessorKey:"Assigned_Date",header:"DATE"},{id:"actions",cell:({row:s})=>e.jsx(G,{data:s.original})}];function q(){const{isAdmin:s}=x(),o=d();return e.jsxs("div",{className:"flex items-center justify-between gap-2 py-5",children:[e.jsx("div",{className:"flex flex-1 gap-4",children:e.jsx(T,{placeholder:"Search Projects"})}),e.jsx("div",{className:"flex gap-3",children:s&&e.jsxs(h,{onClick:()=>o.push("/projects/add-project"),children:[e.jsx(O,{className:"mr-2 h-4 w-4"})," Add New Project"]})})]})}function F({projects:s,pageCount:o}){return e.jsxs(e.Fragment,{children:[e.jsx(q,{}),s&&e.jsx(w,{columns:U,data:s,pageCount:o})]})}function ie(){const[s]=P(),o=Number(s.get("page")||1),a=Number(s.get("limit")||10),i=s.get("search")||null,l=(o-1)*a,{data:r,isLoading:c}=L(l,a,i),n=r==null?void 0:r.projects;console.log(n),n==null||n.map(t=>{var j;console.log(t.Activity[t.Activity.length-1]),t.Building_Status=t==null?void 0:t.Activity[((j=t==null?void 0:t.Activity)==null?void 0:j.length)-1]});const m=r==null?void 0:r.totalProjects,g=r==null?void 0:r.pageCount;return c?e.jsx("div",{className:"p-5",children:e.jsx(b,{columnCount:10,filterableColumnCount:2,searchableColumnCount:1})}):e.jsxs("div",{className:"p-4 md:p-8",children:[e.jsx(y,{title:"Project Management | YSEC"}),e.jsx("div",{className:"flex justify-between",children:e.jsx(M,{items:[{title:"Dashboard",link:"/"},{title:"Projects",link:"/projects"}]})}),e.jsx(F,{projects:n,page:o,totalProjects:m,pageCount:g})]})}export{ie as default};
